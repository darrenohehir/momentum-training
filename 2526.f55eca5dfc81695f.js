"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2526],{2526:(B,_,c)=>{c.r(_),c.d(_,{HomePageModule:()=>L});var d=c(2200),r=c(7343),p=c(8132),h=c(467),t=c(3664),l=c(2615),P=c(6057);let M=(()=>{var e;class o{calculateMomentum(n){const s=n.filter(g=>void 0!==g.endedAt).sort((g,Y)=>{const z=new Date(g.endedAt).getTime();return new Date(Y.endedAt).getTime()-z});if(0===s.length)return{status:"Paused",daysRemaining:0,lastSessionDate:null};const m=s[0].endedAt,f=this.calculateDaysSince(m);return f<=7?{status:"Active",daysRemaining:7-f,lastSessionDate:m}:{status:"Paused",daysRemaining:0,lastSessionDate:m}}calculateDaysSince(n){const s=new Date(n),a=new Date,m=new Date(s.getFullYear(),s.getMonth(),s.getDate()),u=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-m.getTime(),g=Math.floor(u/864e5);return Math.max(0,g)}static#t=e=()=>(this.\u0275fac=function(s){return new(s||o)},this.\u0275prov=l.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}))}return e(),o})();var v=c(8012),b=c(5539);const D=()=>[1,2,3];function k(e,o){1&e&&(t.qex(0),t.j41(1,"ion-card",5)(2,"ion-card-content"),t.nrm(3,"ion-skeleton-text",6)(4,"ion-skeleton-text",7),t.k0s()(),t.bVm())}function F(e,o){if(1&e&&(t.j41(0,"p",15),t.EFF(1),t.k0s()),2&e){const i=t.XpG(2);t.R7$(),t.SpI(" Last session: ",i.formatDate(i.momentum.lastSessionDate)," ")}}function S(e,o){1&e&&(t.j41(0,"p",15),t.EFF(1," No sessions yet "),t.k0s())}function C(e,o){if(1&e&&(t.qex(0),t.j41(1,"ion-card",8)(2,"ion-card-content")(3,"div",9)(4,"span",10),t.EFF(5,"Momentum"),t.k0s(),t.j41(6,"span",11),t.EFF(7),t.k0s()(),t.j41(8,"div",12)(9,"p",13),t.EFF(10),t.k0s(),t.DNE(11,F,2,1,"p",14)(12,S,2,0,"p",14),t.k0s()()(),t.bVm()),2&e){const i=t.XpG();t.R7$(6),t.AVh("active","Active"===i.momentum.status)("paused","Paused"===i.momentum.status),t.R7$(),t.SpI(" ",i.momentum.status," "),t.R7$(3),t.JRh(i.formatDaysRemaining(i.momentum.daysRemaining)),t.R7$(),t.Y8G("ngIf",i.momentum.lastSessionDate),t.R7$(),t.Y8G("ngIf",!i.momentum.lastSessionDate)}}function O(e,o){1&e&&(t.qex(0),t.j41(1,"ion-card",5)(2,"ion-card-content")(3,"p",16),t.EFF(4,"Start a session to begin tracking your momentum."),t.k0s()()(),t.bVm())}function R(e,o){if(1&e&&(t.qex(0),t.j41(1,"ion-card",17)(2,"ion-card-content")(3,"div",18)(4,"div",19)(5,"span",20),t.EFF(6),t.k0s(),t.j41(7,"span",21),t.EFF(8,"XP"),t.k0s()(),t.j41(9,"div",19)(10,"span",20),t.EFF(11),t.k0s(),t.j41(12,"span",21),t.EFF(13,"Level"),t.k0s()()()()(),t.bVm()),2&e){const i=t.XpG();t.R7$(6),t.JRh(i.totalXp),t.R7$(5),t.JRh(i.level)}}function E(e,o){if(1&e){const i=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){l.eBV(i);const s=t.XpG();return l.Njj(s.goToHistory())}),t.EFF(1," See all "),t.k0s()}}function I(e,o){1&e&&(t.j41(0,"ion-item")(1,"ion-label"),t.nrm(2,"ion-skeleton-text",25)(3,"ion-skeleton-text",26),t.k0s()())}function j(e,o){1&e&&(t.qex(0),t.j41(1,"ion-list",23),t.DNE(2,I,4,0,"ion-item",24),t.k0s(),t.bVm()),2&e&&(t.R7$(2),t.Y8G("ngForOf",t.lJ4(1,D)))}function T(e,o){if(1&e&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&e){const i=o.ngIf;t.R7$(),t.SpI(" \xb7 ",i," min")}}function $(e,o){if(1&e){const i=t.RV6();t.j41(0,"ion-item",30),t.bIt("click",function(){const s=l.eBV(i).$implicit,a=t.XpG(3);return l.Njj(a.viewSession(s))}),t.j41(1,"ion-label")(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.DNE(6,T,2,1,"span",2),t.k0s()()()}if(2&e){const i=o.$implicit,n=t.XpG(3);t.R7$(3),t.JRh(n.getQuestName(i)),t.R7$(2),t.SpI(" ",n.formatFullDate(i.endedAt)," "),t.R7$(),t.Y8G("ngIf",n.getDuration(i))}}function w(e,o){if(1&e&&(t.j41(0,"ion-list",23),t.DNE(1,$,7,3,"ion-item",29),t.k0s()),2&e){const i=t.XpG(2);t.R7$(),t.Y8G("ngForOf",i.recentSessions)}}function G(e,o){1&e&&(t.j41(0,"div",31)(1,"p"),t.EFF(2,"No completed sessions yet."),t.k0s()())}function H(e,o){if(1&e&&(t.qex(0),t.DNE(1,w,2,1,"ion-list",27)(2,G,3,0,"div",28),t.bVm()),2&e){const i=t.XpG();t.R7$(),t.Y8G("ngIf",i.recentSessions.length>0),t.R7$(),t.Y8G("ngIf",0===i.recentSessions.length)}}const y={quick:"Quick Session","full-body":"Full Body",upper:"Upper Body",lower:"Lower Body"},X=[{path:"",component:(()=>{var e;class o{constructor(n,s,a,m){this.db=n,this.momentumService=s,this.router=a,this.appEvents=m,this.momentum=null,this.recentSessions=[],this.totalXp=0,this.level=1,this.isLoading=!0,this.sessionDataSub=null}ngOnInit(){this.sessionDataSub=this.appEvents.sessionDataChanged$.subscribe(()=>{this.loadData()})}ngOnDestroy(){this.sessionDataSub&&(this.sessionDataSub.unsubscribe(),this.sessionDataSub=null)}ionViewWillEnter(){var n=this;return(0,h.A)(function*(){yield n.loadData()})()}loadData(){var n=this;return(0,h.A)(function*(){n.isLoading=!0;try{const s=yield n.db.getRecentCompletedSessions(5);n.momentum=n.momentumService.calculateMomentum(s),n.recentSessions=s;const a=yield n.db.getGamificationState();n.totalXp=a?.totalXp??0,n.level=function x(e){return Math.floor(e/1e3)+1}(n.totalXp)}catch(s){console.error("Failed to load home data:",s),n.momentum=null,n.recentSessions=[],n.totalXp=0,n.level=1}finally{n.isLoading=!1}})()}viewSession(n){this.router.navigate(["/history",n.id])}formatDate(n){return n?new Date(n).toLocaleDateString([],{month:"short",day:"numeric"}):""}formatFullDate(n){return n?new Date(n).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}):""}getDuration(n){if(!n.startedAt||!n.endedAt)return null;const s=new Date(n.startedAt).getTime(),a=new Date(n.endedAt).getTime(),m=Math.round((a-s)/6e4);return Math.max(1,m)}formatDaysRemaining(n){return 0===n?"0 days remaining":1===n?"1 day remaining":`${n} days remaining`}getQuestName(n){return n.questId&&y[n.questId]?y[n.questId]:"Session"}goToHistory(){this.router.navigate(["/tabs/history"])}static#t=e=()=>(this.\u0275fac=function(s){return new(s||o)(t.rXU(P.at),t.rXU(M),t.rXU(v.Ix),t.rXU(b.k))},this.\u0275cmp=t.VBU({type:o,selectors:[["app-home"]],standalone:!1,decls:17,vars:7,consts:[[1,"ion-padding"],["expand","block","size","large","routerLink","/start-session",1,"start-session-btn"],[4,"ngIf"],[1,"section-header"],["class","see-all-link",3,"click",4,"ngIf"],[1,"status-card"],["animated","",2,"width","40%","height","24px"],["animated","",2,"width","60%","height","16px","margin-top","8px"],[1,"status-card","momentum-card"],[1,"momentum-header"],[1,"momentum-label"],[1,"momentum-status"],[1,"momentum-details"],[1,"days-remaining"],["class","last-session",4,"ngIf"],[1,"last-session"],[1,"empty-momentum"],[1,"status-card","xp-card"],[1,"xp-level-row"],[1,"stat"],[1,"stat-value"],[1,"stat-label"],[1,"see-all-link",3,"click"],[1,"sessions-list"],[4,"ngFor","ngForOf"],["animated","",2,"width","50%"],["animated","",2,"width","70%","margin-top","4px"],["class","sessions-list",4,"ngIf"],["class","empty-sessions",4,"ngIf"],["button","","detail","true",3,"click",4,"ngFor","ngForOf"],["button","","detail","true",3,"click"],[1,"empty-sessions"]],template:function(s,a){1&s&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Momentum"),t.k0s()()(),t.j41(4,"ion-content",0)(5,"ion-button",1),t.EFF(6," Start Session "),t.k0s(),t.DNE(7,k,5,0,"ng-container",2)(8,C,13,8,"ng-container",2)(9,O,5,0,"ng-container",2)(10,R,14,2,"ng-container",2),t.j41(11,"div",3)(12,"h2"),t.EFF(13,"Recent Sessions"),t.k0s(),t.DNE(14,E,2,0,"button",4),t.k0s(),t.DNE(15,j,3,2,"ng-container",2)(16,H,3,2,"ng-container",2),t.k0s()),2&s&&(t.R7$(7),t.Y8G("ngIf",a.isLoading),t.R7$(),t.Y8G("ngIf",!a.isLoading&&a.momentum),t.R7$(),t.Y8G("ngIf",!a.isLoading&&!a.momentum),t.R7$(),t.Y8G("ngIf",!a.isLoading),t.R7$(4),t.Y8G("ngIf",a.recentSessions.length>0),t.R7$(),t.Y8G("ngIf",a.isLoading),t.R7$(),t.Y8G("ngIf",!a.isLoading))},dependencies:[d.Sq,d.bT,r.Jm,r.b_,r.I9,r.W9,r.eU,r.uz,r.he,r.nf,r.ds,r.BC,r.ai,r.N7,p.Wk],styles:['@charset "UTF-8";.start-session-btn[_ngcontent-%COMP%]{margin-bottom:20px;--border-radius: 8px}.status-card[_ngcontent-%COMP%]{margin-bottom:16px}.momentum-card[_ngcontent-%COMP%]{border-left:3px solid var(--ion-color-primary)}.momentum-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:20px}.momentum-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.momentum-label[_ngcontent-%COMP%]{font-size:.85rem;text-transform:uppercase;letter-spacing:.75px;font-weight:600;opacity:.7}.momentum-status[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;padding:6px 14px;border-radius:4px}.momentum-status.active[_ngcontent-%COMP%]{color:var(--ion-color-success);background:rgba(var(--ion-color-success-rgb),.15)}.momentum-status.paused[_ngcontent-%COMP%]{color:var(--ion-color-medium);background:var(--ion-color-step-100)}.momentum-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.days-remaining[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600}.last-session[_ngcontent-%COMP%]{margin:0;font-size:.9rem;opacity:.6}.empty-momentum[_ngcontent-%COMP%]{margin:0;opacity:.5;text-align:center}.xp-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:12px 16px}.xp-level-row[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.stat[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2px}.stat-value[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500;font-family:IBM Plex Mono,monospace;opacity:.85}.stat-label[_ngcontent-%COMP%]{font-size:.7rem;text-transform:uppercase;letter-spacing:.5px;opacity:.4}.section-header[_ngcontent-%COMP%]{margin:24px 0 12px;display:flex;justify-content:space-between;align-items:center}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;opacity:.5}.section-header[_ngcontent-%COMP%]   .see-all-link[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--ion-color-primary);font-size:.85rem;padding:0;cursor:pointer;opacity:.9}.section-header[_ngcontent-%COMP%]   .see-all-link[_ngcontent-%COMP%]:hover{opacity:1}.sessions-list[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;background:transparent}.sessions-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-step-100);margin-bottom:8px;border-radius:8px}.sessions-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;margin:0}.sessions-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;opacity:.6;margin:4px 0 0}.empty-sessions[_ngcontent-%COMP%]{text-align:center;padding:24px;opacity:.5}.empty-sessions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}']}))}return e(),o})()}];let A=(()=>{var e;class o{static#t=e=()=>(this.\u0275fac=function(s){return new(s||o)},this.\u0275mod=t.$C({type:o}),this.\u0275inj=l.G2t({imports:[p.iI.forChild(X),p.iI]}))}return e(),o})(),L=(()=>{var e;class o{static#t=e=()=>(this.\u0275fac=function(s){return new(s||o)},this.\u0275mod=t.$C({type:o}),this.\u0275inj=l.G2t({imports:[d.MD,r.bv,A]}))}return e(),o})()}}]);